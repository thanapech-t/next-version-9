{"version":3,"file":"static/webpack/static\\development\\pages\\index.js.0bf1cf9fccc8e760c143.hot-update.js","sources":["webpack:///./ducks/auth/index.js"],"sourcesContent":["import { put, takeLatest, delay } from 'redux-saga/effects'\r\nimport { createReducer, Creator } from '../helper'\r\nimport axios from 'axios'\r\n\r\nconst SET_DATA_AUTH = 'SET_DATA_AUTH'\r\nconst GET_DATA_AUTH = 'GET_DATA_AUTH'\r\nconst LOGIN = 'LOGIN'\r\nconst LOGOUT = 'LOGOUT'\r\n\r\nexport const setDataUser = Creator(SET_DATA_AUTH, 'data')\r\nexport const getUserInfo = Creator(GET_DATA_AUTH)\r\nexport const login = Creator(LOGIN, 'data')\r\nexport const logout = Creator(LOGOUT)\r\n\r\nexport function* getUserInfoSaga() {\r\n  try {\r\n    const checkToken = sessionStorage.getItem('loginPlayground')\r\n    const response = yield axios.get('/api/auth', {\r\n      token: checkToken,\r\n    })\r\n    console.log('response', response)\r\n    if (checkToken) {\r\n      yield put(setDataUser({ isLogin: true }))\r\n    }\r\n  } catch (error) {\r\n  } finally {\r\n    yield put(setDataUser({ initialized: true }))\r\n  }\r\n}\r\n\r\nexport function* loginSaga({ payload: { data } }) {\r\n  console.log('data', data)\r\n  try {\r\n    const response = yield axios.post('/api/auth', data)\r\n    console.log(response)\r\n    sessionStorage.setItem('twittee', response.data.token)\r\n    yield put(setDataUser({ user: response.data, isLogin: true }))\r\n  } catch (error) {\r\n  } finally {\r\n    yield put(\r\n      setDataUser({\r\n        isLoading: false,\r\n      }),\r\n    )\r\n  }\r\n}\r\n\r\nexport function* logoutSaga() {\r\n  try {\r\n    sessionStorage.clear()\r\n    yield put(setDataUser({ isLogin: false }))\r\n  } catch (error) {\r\n  } finally {\r\n    yield put(\r\n      setDataUser({\r\n        isLoading: false,\r\n      }),\r\n    )\r\n  }\r\n}\r\n\r\nexport function* authWatcher() {\r\n  yield takeLatest(GET_DATA_AUTH, getUserInfoSaga)\r\n  yield takeLatest(LOGIN, loginSaga)\r\n  yield takeLatest(LOGOUT, logoutSaga)\r\n}\r\n\r\nconst initial = {\r\n  user: {},\r\n  initialized: false,\r\n  isLogin: false,\r\n  isLoading: false,\r\n  routes: [],\r\n}\r\n\r\nconst reducer = createReducer(initial, state => ({\r\n  [SET_DATA_AUTH]: ({ data }) => ({\r\n    ...state,\r\n    ...data,\r\n  }),\r\n}))\r\n\r\nexport default reducer\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAcA;;;AAgBA;;;AAiBA;;;AAcA;AACA;AA9DA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAFA;AAGA;AACA;AADA;AACA;AAJA;AAGA;AAGA;AACA;AAPA;AAAA;AAAA;AAAA;AACA;AADA;AAQA;AAAA;AAAA;AACA;AATA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAYA;AAAA;AAAA;AACA;AAbA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAgBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAGA;AACA;AAJA;AAGA;AACA;AACA;AALA;AAMA;AAAA;AAAA;AAAA;AACA;AAPA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AASA;AAEA;AADA;AACA;AAXA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAiBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAFA;AAGA;AAAA;AAAA;AACA;AAJA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAMA;AAEA;AADA;AACA;AARA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAcA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAEA;AACA;AAHA;AAAA;AAGA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AACA;AACA;AACA;AACA;AACA;AALA;AAQA;AAAA;AACA;AAAA;AAAA;AADA;AAOA;;;;A","sourceRoot":""}