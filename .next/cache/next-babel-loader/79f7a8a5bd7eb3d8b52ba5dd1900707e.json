{"ast":null,"code":"import _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\n\nvar _marked =\n/*#__PURE__*/\n_regeneratorRuntime.mark(getUserInfoSaga),\n    _marked2 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(loginSaga),\n    _marked3 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(logoutSaga),\n    _marked4 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(authWatcher);\n\nimport { put, takeLatest, delay } from 'redux-saga/effects';\nimport { createReducer, Creator } from '../helper';\nimport axios from 'axios';\nvar SET_DATA_AUTH = 'SET_DATA_AUTH';\nvar GET_DATA_AUTH = 'GET_DATA_AUTH';\nvar LOGIN = 'LOGIN';\nvar LOGOUT = 'LOGOUT';\nexport var setDataUser = Creator(SET_DATA_AUTH, 'data');\nexport var getUserInfo = Creator(GET_DATA_AUTH);\nexport var login = Creator(LOGIN, 'data');\nexport var logout = Creator(LOGOUT);\nexport function getUserInfoSaga() {\n  var checkToken, response;\n  return _regeneratorRuntime.wrap(function getUserInfoSaga$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.prev = 0;\n          checkToken = sessionStorage.getItem('loginPlayground');\n          _context.next = 4;\n          return axios.get('/api/auth', {\n            token: checkToken\n          });\n\n        case 4:\n          response = _context.sent;\n          console.log('response', response);\n\n          if (!checkToken) {\n            _context.next = 9;\n            break;\n          }\n\n          _context.next = 9;\n          return put(setDataUser({\n            isLogin: true\n          }));\n\n        case 9:\n          _context.next = 13;\n          break;\n\n        case 11:\n          _context.prev = 11;\n          _context.t0 = _context[\"catch\"](0);\n\n        case 13:\n          _context.prev = 13;\n          _context.next = 16;\n          return put(setDataUser({\n            initialized: true\n          }));\n\n        case 16:\n          return _context.finish(13);\n\n        case 17:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _marked, null, [[0, 11, 13, 17]]);\n}\nexport function loginSaga(_ref) {\n  var data, response;\n  return _regeneratorRuntime.wrap(function loginSaga$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          data = _ref.payload.data;\n          console.log('data', data);\n          _context2.prev = 2;\n          _context2.next = 5;\n          return axios.get('/api/auth', {\n            data: data\n          });\n\n        case 5:\n          response = _context2.sent;\n          sessionStorage.setItem('loginPlayground', true);\n          _context2.next = 9;\n          return put(setDataUser({\n            user: {\n              id: data.id\n            },\n            isLogin: true\n          }));\n\n        case 9:\n          _context2.next = 13;\n          break;\n\n        case 11:\n          _context2.prev = 11;\n          _context2.t0 = _context2[\"catch\"](2);\n\n        case 13:\n          _context2.prev = 13;\n          _context2.next = 16;\n          return put(setDataUser({\n            isLoading: false\n          }));\n\n        case 16:\n          return _context2.finish(13);\n\n        case 17:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, _marked2, null, [[2, 11, 13, 17]]);\n}\nexport function logoutSaga() {\n  return _regeneratorRuntime.wrap(function logoutSaga$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.prev = 0;\n          sessionStorage.clear();\n          _context3.next = 4;\n          return put(setDataUser({\n            isLogin: false\n          }));\n\n        case 4:\n          _context3.next = 8;\n          break;\n\n        case 6:\n          _context3.prev = 6;\n          _context3.t0 = _context3[\"catch\"](0);\n\n        case 8:\n          _context3.prev = 8;\n          _context3.next = 11;\n          return put(setDataUser({\n            isLoading: false\n          }));\n\n        case 11:\n          return _context3.finish(8);\n\n        case 12:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  }, _marked3, null, [[0, 6, 8, 12]]);\n}\nexport function authWatcher() {\n  return _regeneratorRuntime.wrap(function authWatcher$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          _context4.next = 2;\n          return takeLatest(GET_DATA_AUTH, getUserInfoSaga);\n\n        case 2:\n          _context4.next = 4;\n          return takeLatest(LOGIN, loginSaga);\n\n        case 4:\n          _context4.next = 6;\n          return takeLatest(LOGOUT, logoutSaga);\n\n        case 6:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  }, _marked4);\n}\nvar initial = {\n  user: {},\n  initialized: false,\n  isLogin: false,\n  isLoading: false,\n  routes: []\n};\nvar reducer = createReducer(initial, function (state) {\n  return _defineProperty({}, SET_DATA_AUTH, function (_ref2) {\n    var data = _ref2.data;\n    return _objectSpread({}, state, data);\n  });\n});\nexport default reducer;","map":{"version":3,"sources":["D:\\project\\next-v-9\\ducks\\auth\\index.js"],"names":["getUserInfoSaga","loginSaga","logoutSaga","authWatcher","put","takeLatest","delay","createReducer","Creator","axios","SET_DATA_AUTH","GET_DATA_AUTH","LOGIN","LOGOUT","setDataUser","getUserInfo","login","logout","checkToken","sessionStorage","getItem","get","token","response","console","log","isLogin","initialized","data","payload","setItem","user","id","isLoading","clear","initial","routes","reducer","state"],"mappings":";;;;;;yBAciBA,e;;;yBAgBAC,S;;;yBAkBAC,U;;;yBAcAC,W;;AA9DjB,SAASC,GAAT,EAAcC,UAAd,EAA0BC,KAA1B,QAAuC,oBAAvC;AACA,SAASC,aAAT,EAAwBC,OAAxB,QAAuC,WAAvC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,IAAMC,aAAa,GAAG,eAAtB;AACA,IAAMC,aAAa,GAAG,eAAtB;AACA,IAAMC,KAAK,GAAG,OAAd;AACA,IAAMC,MAAM,GAAG,QAAf;AAEA,OAAO,IAAMC,WAAW,GAAGN,OAAO,CAACE,aAAD,EAAgB,MAAhB,CAA3B;AACP,OAAO,IAAMK,WAAW,GAAGP,OAAO,CAACG,aAAD,CAA3B;AACP,OAAO,IAAMK,KAAK,GAAGR,OAAO,CAACI,KAAD,EAAQ,MAAR,CAArB;AACP,OAAO,IAAMK,MAAM,GAAGT,OAAO,CAACK,MAAD,CAAtB;AAEP,OAAO,SAAUb,eAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEGkB,UAAAA,UAFH,GAEgBC,cAAc,CAACC,OAAf,CAAuB,iBAAvB,CAFhB;AAAA;AAGc,iBAAMX,KAAK,CAACY,GAAN,CAAU,WAAV,EAAuB;AAC5CC,YAAAA,KAAK,EAAEJ;AADqC,WAAvB,CAAN;;AAHd;AAGGK,UAAAA,QAHH;AAMHC,UAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBF,QAAxB;;AANG,eAOCL,UAPD;AAAA;AAAA;AAAA;;AAAA;AAQD,iBAAMd,GAAG,CAACU,WAAW,CAAC;AAAEY,YAAAA,OAAO,EAAE;AAAX,WAAD,CAAZ,CAAT;;AARC;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAYH,iBAAMtB,GAAG,CAACU,WAAW,CAAC;AAAEa,YAAAA,WAAW,EAAE;AAAf,WAAD,CAAZ,CAAT;;AAZG;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAgBP,OAAO,SAAU1B,SAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiC2B,UAAAA,IAAjC,QAAsBC,OAAtB,CAAiCD,IAAjC;AACLJ,UAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBG,IAApB;AADK;AAAA;AAGc,iBAAMnB,KAAK,CAACY,GAAN,CAAU,WAAV,EAAuB;AAC5CO,YAAAA,IAAI,EAAEA;AADsC,WAAvB,CAAN;;AAHd;AAGGL,UAAAA,QAHH;AAMHJ,UAAAA,cAAc,CAACW,OAAf,CAAuB,iBAAvB,EAA0C,IAA1C;AANG;AAOH,iBAAM1B,GAAG,CAACU,WAAW,CAAC;AAAEiB,YAAAA,IAAI,EAAE;AAAEC,cAAAA,EAAE,EAAEJ,IAAI,CAACI;AAAX,aAAR;AAAyBN,YAAAA,OAAO,EAAE;AAAlC,WAAD,CAAZ,CAAT;;AAPG;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAUH,iBAAMtB,GAAG,CACPU,WAAW,CAAC;AACVmB,YAAAA,SAAS,EAAE;AADD,WAAD,CADJ,CAAT;;AAVG;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAkBP,OAAO,SAAU/B,UAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAEHiB,UAAAA,cAAc,CAACe,KAAf;AAFG;AAGH,iBAAM9B,GAAG,CAACU,WAAW,CAAC;AAAEY,YAAAA,OAAO,EAAE;AAAX,WAAD,CAAZ,CAAT;;AAHG;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAMH,iBAAMtB,GAAG,CACPU,WAAW,CAAC;AACVmB,YAAAA,SAAS,EAAE;AADD,WAAD,CADJ,CAAT;;AANG;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAcP,OAAO,SAAU9B,WAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AACL,iBAAME,UAAU,CAACM,aAAD,EAAgBX,eAAhB,CAAhB;;AADK;AAAA;AAEL,iBAAMK,UAAU,CAACO,KAAD,EAAQX,SAAR,CAAhB;;AAFK;AAAA;AAGL,iBAAMI,UAAU,CAACQ,MAAD,EAASX,UAAT,CAAhB;;AAHK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMP,IAAMiC,OAAO,GAAG;AACdJ,EAAAA,IAAI,EAAE,EADQ;AAEdJ,EAAAA,WAAW,EAAE,KAFC;AAGdD,EAAAA,OAAO,EAAE,KAHK;AAIdO,EAAAA,SAAS,EAAE,KAJG;AAKdG,EAAAA,MAAM,EAAE;AALM,CAAhB;AAQA,IAAMC,OAAO,GAAG9B,aAAa,CAAC4B,OAAD,EAAU,UAAAG,KAAK;AAAA,6BACzC5B,aADyC,EACzB;AAAA,QAAGkB,IAAH,SAAGA,IAAH;AAAA,6BACZU,KADY,EAEZV,IAFY;AAAA,GADyB;AAAA,CAAf,CAA7B;AAOA,eAAeS,OAAf","sourcesContent":["import { put, takeLatest, delay } from 'redux-saga/effects'\r\nimport { createReducer, Creator } from '../helper'\r\nimport axios from 'axios'\r\n\r\nconst SET_DATA_AUTH = 'SET_DATA_AUTH'\r\nconst GET_DATA_AUTH = 'GET_DATA_AUTH'\r\nconst LOGIN = 'LOGIN'\r\nconst LOGOUT = 'LOGOUT'\r\n\r\nexport const setDataUser = Creator(SET_DATA_AUTH, 'data')\r\nexport const getUserInfo = Creator(GET_DATA_AUTH)\r\nexport const login = Creator(LOGIN, 'data')\r\nexport const logout = Creator(LOGOUT)\r\n\r\nexport function* getUserInfoSaga() {\r\n  try {\r\n    const checkToken = sessionStorage.getItem('loginPlayground')\r\n    const response = yield axios.get('/api/auth', {\r\n      token: checkToken,\r\n    })\r\n    console.log('response', response)\r\n    if (checkToken) {\r\n      yield put(setDataUser({ isLogin: true }))\r\n    }\r\n  } catch (error) {\r\n  } finally {\r\n    yield put(setDataUser({ initialized: true }))\r\n  }\r\n}\r\n\r\nexport function* loginSaga({ payload: { data } }) {\r\n  console.log('data', data)\r\n  try {\r\n    const response = yield axios.get('/api/auth', {\r\n      data: data,\r\n    })\r\n    sessionStorage.setItem('loginPlayground', true)\r\n    yield put(setDataUser({ user: { id: data.id }, isLogin: true }))\r\n  } catch (error) {\r\n  } finally {\r\n    yield put(\r\n      setDataUser({\r\n        isLoading: false,\r\n      }),\r\n    )\r\n  }\r\n}\r\n\r\nexport function* logoutSaga() {\r\n  try {\r\n    sessionStorage.clear()\r\n    yield put(setDataUser({ isLogin: false }))\r\n  } catch (error) {\r\n  } finally {\r\n    yield put(\r\n      setDataUser({\r\n        isLoading: false,\r\n      }),\r\n    )\r\n  }\r\n}\r\n\r\nexport function* authWatcher() {\r\n  yield takeLatest(GET_DATA_AUTH, getUserInfoSaga)\r\n  yield takeLatest(LOGIN, loginSaga)\r\n  yield takeLatest(LOGOUT, logoutSaga)\r\n}\r\n\r\nconst initial = {\r\n  user: {},\r\n  initialized: false,\r\n  isLogin: false,\r\n  isLoading: false,\r\n  routes: [],\r\n}\r\n\r\nconst reducer = createReducer(initial, state => ({\r\n  [SET_DATA_AUTH]: ({ data }) => ({\r\n    ...state,\r\n    ...data,\r\n  }),\r\n}))\r\n\r\nexport default reducer\r\n"]},"metadata":{},"sourceType":"module"}