{"ast":null,"code":"import _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport database from '../../db.json';\nimport axios from 'axios';\n\nvar randomToken = function randomToken() {\n  return Math.random().toString(36).substr(2).toUpperCase();\n};\n\nexport default function handle(req, res) {\n  var method = req.method,\n      body = req.body,\n      query = req.query;\n\n  if (method === 'GET') {\n    var user = database.users.find(function (value) {\n      return value.token === query.token;\n    });\n\n    if (user) {\n      res.send(user);\n    } else {\n      res.status(404).send('user not found');\n    }\n  }\n\n  if (method === 'POST') {\n    var _user = database.users.find(function (value) {\n      return value.email === body.email && value.password === body.password;\n    });\n\n    if (_user) {\n      var token = randomToken() + randomToken();\n\n      var newUser = _objectSpread({}, _user, {\n        token: token\n      });\n\n      axios.put(\"http://localhost:3004/users/\".concat(_user.id), newUser);\n      res.send(newUser);\n    } else {\n      res.status(401).send('Unauthorized');\n    }\n  }\n}","map":{"version":3,"sources":["D:\\project\\next-v-9\\pages\\api\\auth.js"],"names":["database","axios","randomToken","Math","random","toString","substr","toUpperCase","handle","req","res","method","body","query","user","users","find","value","token","send","status","email","password","newUser","put","id"],"mappings":";AAAA,OAAOA,QAAP,MAAqB,eAArB;AACA,OAAOC,KAAP,MAAkB,OAAlB;;AAEA,IAAMC,WAAW,GAAG,SAAdA,WAAc;AAAA,SAClBC,IAAI,CAACC,MAAL,GACGC,QADH,CACY,EADZ,EAEGC,MAFH,CAEU,CAFV,EAGGC,WAHH,EADkB;AAAA,CAApB;;AAMA,eAAe,SAASC,MAAT,CAAgBC,GAAhB,EAAqBC,GAArB,EAA0B;AAAA,MAC/BC,MAD+B,GACPF,GADO,CAC/BE,MAD+B;AAAA,MACvBC,IADuB,GACPH,GADO,CACvBG,IADuB;AAAA,MACjBC,KADiB,GACPJ,GADO,CACjBI,KADiB;;AAGvC,MAAIF,MAAM,KAAK,KAAf,EAAsB;AACpB,QAAMG,IAAI,GAAGd,QAAQ,CAACe,KAAT,CAAeC,IAAf,CAAoB,UAAAC,KAAK;AAAA,aAAIA,KAAK,CAACC,KAAN,KAAgBL,KAAK,CAACK,KAA1B;AAAA,KAAzB,CAAb;;AACA,QAAIJ,IAAJ,EAAU;AACRJ,MAAAA,GAAG,CAACS,IAAJ,CAASL,IAAT;AACD,KAFD,MAEO;AACLJ,MAAAA,GAAG,CAACU,MAAJ,CAAW,GAAX,EAAgBD,IAAhB,CAAqB,gBAArB;AACD;AACF;;AAED,MAAIR,MAAM,KAAK,MAAf,EAAuB;AACrB,QAAMG,KAAI,GAAGd,QAAQ,CAACe,KAAT,CAAeC,IAAf,CACX,UAAAC,KAAK;AAAA,aAAIA,KAAK,CAACI,KAAN,KAAgBT,IAAI,CAACS,KAArB,IAA8BJ,KAAK,CAACK,QAAN,KAAmBV,IAAI,CAACU,QAA1D;AAAA,KADM,CAAb;;AAGA,QAAIR,KAAJ,EAAU;AACR,UAAMI,KAAK,GAAGhB,WAAW,KAAKA,WAAW,EAAzC;;AACA,UAAMqB,OAAO,qBAAQT,KAAR;AAAcI,QAAAA,KAAK,EAALA;AAAd,QAAb;;AACAjB,MAAAA,KAAK,CAACuB,GAAN,uCAAyCV,KAAI,CAACW,EAA9C,GAAoDF,OAApD;AACAb,MAAAA,GAAG,CAACS,IAAJ,CAASI,OAAT;AACD,KALD,MAKO;AACLb,MAAAA,GAAG,CAACU,MAAJ,CAAW,GAAX,EAAgBD,IAAhB,CAAqB,cAArB;AACD;AACF;AACF","sourcesContent":["import database from '../../db.json'\r\nimport axios from 'axios'\r\n\r\nconst randomToken = () =>\r\n  Math.random()\r\n    .toString(36)\r\n    .substr(2)\r\n    .toUpperCase()\r\n\r\nexport default function handle(req, res) {\r\n  const { method, body, query } = req\r\n\r\n  if (method === 'GET') {\r\n    const user = database.users.find(value => value.token === query.token)\r\n    if (user) {\r\n      res.send(user)\r\n    } else {\r\n      res.status(404).send('user not found')\r\n    }\r\n  }\r\n\r\n  if (method === 'POST') {\r\n    const user = database.users.find(\r\n      value => value.email === body.email && value.password === body.password,\r\n    )\r\n    if (user) {\r\n      const token = randomToken() + randomToken()\r\n      const newUser = { ...user, token }\r\n      axios.put(`http://localhost:3004/users/${user.id}`, newUser)\r\n      res.send(newUser)\r\n    } else {\r\n      res.status(401).send('Unauthorized')\r\n    }\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}